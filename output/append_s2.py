# Load necessary modules 
import numpy as np
import math
from sklearn.cross_validation import train_test_split
from sklearn import linear_model
from sklearn.externals import joblib

def load_set():
	"""A function for loading and splitting dataset"""
	### Load in dataset that contains s2 order parameter and features information for all RNAs ###
	dataset = np.loadtxt("10.0.All.txt", usecols = range(1, 80))	
	### Set y to s2 order parameters ###
	y = dataset[:, 0]
	### Set x to features ###
	x = dataset[:, 1:]
	### Define x_train, x_test, y_train, y_test as global variables ###
	global x_train
	global x_test
	global y_train
	global y_test
	### Randomly split dataset into training and testing ###
	x_train, x_test, y_train, y_test = train_test_split(x, y, test_size = 0.4, random_state=0) 
	x_train.shape, y_train.shape, x_test.shape, y_test.shape
	for i in x_train:
		print i
	
def load_saved_model():
	"""A function for training the linear regression model and obtaining predicted s2 order parameters"""
	reg = linear_model.LinearRegression()
	reg.fit(x_train, y_train)
	#saved_model = ["general_LR_25.0.pkl"]
	#saved_model = ["general_LR_10.0.pkl", "general_LR_15.0.pkl", "general_LR_20.0.pkl", "general_LR_25.0.pkl"] # load saved model
	for i in saved_model:
		loaded_model = joblib.load(i)
		s2 = reg.predict(x_train)
		print s2.tolist() # print predicted s2 order parameters
		
def append_s2():	
	"""A function for appending the predicted s2 order parameters from the 
	LR model as an additional feature of the RF model"""
	s2_list = [0.8004024767103817, 0.7157848725468876, 0.6699017409496817, 0.7695918521889891, 0.7105520461136037, 0.8093148126979719, 0.7318086318321593, 0.8759987045923225, 0.4506671227163601, 0.8552643214157307, 0.8150073147838672, 0.3940785991676672, 0.7831873830095504, 0.8218289806730035, 0.8662124345389437, 0.4032911272064157, 0.800022727618207, 0.6231633158219696, 0.7770569890778394, 0.8063703383028076, 0.4058393392894095, 0.7749485048695963, 0.7818762654394604, 0.6042537667163705, 0.4427523700004301, 0.7675232545916331, 0.7087152733605768, 0.5424156848764909, 0.7611093754576903, 0.7725714708538487, 0.730106237818337, 0.7480807062687289, 0.6363075740722233, 0.8016712514603912, 0.8373096136585512, 0.8751892281326079, 0.8275027537370729, 0.6630418373932045, 0.3707202928393605, 0.7380761985745059, 0.7472452004979948, 0.830496635935311, 0.7758461744304086, 0.8394983959914131, 0.826639398205715, 0.8603755575012813, 0.38027285783674913, 0.6439730931285921, 0.7955616854547378, 0.8573073435498142, 0.8154100073153077, 0.6510447067629743, 0.6369104965795016, 0.8599772182478216, 0.7858688145659631, 0.7115405156316437, 0.8247366519078485, 0.8733977952372804, 0.8453465189467091, 0.8229597974386202, 0.6451089807956196, 0.872038287404963, 0.6636988221919575, 0.7182811260431292, 0.5172351596238738, 0.8894359478104115, 0.6789353344961893, 0.8663523832036646, 0.7862777505441889, 0.783602821535504, 0.8527170430840239, 0.8107380751293507, 0.7824793361202691, 0.7244800047040505, 0.7290995358055226, 0.7925229741241726, 0.5797707206718601, 0.7195529856912704, 0.7405356985501561, 0.4157850284379878, 0.7970460277750953, 0.7962964069433573, 0.6658962978041691, 0.7456359386459559, 0.6848550144835184, 0.8679028865955012, 0.9272733717949484, 0.4950165073671935, 0.7338687438244877, 0.8109648795831836, 0.8241545509802279, 0.7896437673418844, 0.9177351235460371, 0.5913769894254266, 0.6857373593007063, 0.7472183476239336, 0.7166464277490274, 0.802528077896236, 0.7442402540813993, 0.7189157550985554, 0.7980340579980709, 0.8119056754867862, 0.7724891111075582, 0.8124052048545425, 0.7155360717557129, 0.6575507667032563, 0.8449755675759729, 0.6303599348096942, 0.5507936050701192, 0.8544837741569575, 0.7479588874729537, 0.8407314361687794, 0.5047433836207225, 0.8826974358435529, 0.7620148208584985, 0.9207060450036926, 0.7315068716118278, 0.5416905323488097, 0.8893132141812938, 0.8189023185200892, 0.822110208979437, 0.25696103925081126, 0.8770182919056302, 0.32070231702129903, 0.6617473698678611, 0.7348360787592843, 0.757782904843505, 0.7485007227855027, 0.7482771184730457, 0.6100544210005208, 0.5833149679585177, 0.8612810152815948, 0.7662409102022034, 0.7886039516137793, 0.6428618206503007, 0.40362809377653996, 0.8269505436824265, 0.7158191849316407, 0.4304873216924785, 0.7002254599263662, 0.7944123142270654, 0.8428254004703659, 0.7303737971756104, 0.3775334326290294, 0.7709040111689582, 0.8076624667719836, 0.7232625566227668, 0.730424031961624, 0.7983453447089961, 0.6300187379367757, 0.8701212902378563, 0.6898092615121281, 0.5790589132473907, 0.7809366224557712, 0.8363674914790586, 0.6909629569734579, 0.4454599668298871, 0.7802727509612597, 0.815752064229555, 0.793671288350777, 0.8071471348464814, 0.532742698622328, 0.8315708606885786, 0.8075701137603597, 0.7010424519751493, 0.6289830401141201, 0.7961704965374727, 0.6973623055369542, 0.7768892837450336, 0.7885539443807599, 0.6538912250253441, 0.8682563367949199, 0.746268736486319, 0.6299206076447936, 0.774190533723176, 0.2375234025316184, 0.743378799921157, 0.29344388971186697, 0.5733318237571432, 0.7659957829727866, 0.8257531132838605, 0.4490159677613301, 0.7908319268134456, 0.7807919749405399, 0.8244739733654429, 0.7876094791542976, 0.809809534314111, 0.7580743781147758, 0.8152410613885064, 0.855512362994862, 0.6787650590597265, 0.7664150992234158, 0.7651359854553281, 0.7918433432459511, 0.21111445142484642, 0.7911423075055224, 0.6619210343931166, 0.6229815029043533, 0.7577603565512867, 0.586163878626601, 0.7406982479356456, 0.7547395138472475, 0.743461799519402, 0.8496048863147803, 0.826427275128655, 0.7815188252533709, 0.7141349660696374, 0.5599716978744917, 0.8031855335538751, 0.5043803614387843, 0.7119632388226, 0.7749790751346943, 0.8054680879817477, 0.7457431176878695, 0.765189652490639, 0.8106046984489679, 0.7724352358072928, 0.6008874555778514, 0.815143004716455, 0.624667561781177, 0.7952017132373632, 0.7922394048018664, 0.770934664585343, 0.8224867313123287, 0.7165191105870996, 0.7623055189064687, 0.8228306939392598, 0.8993629382360375, 0.7034763823838619, 0.8386913598891568, 0.834482370134711, 0.7695877054015814, 0.6356989561982778, 0.6146150819571352, 0.751606890015265, 0.7595954583139417, 0.8808126237675549, 0.5308606086909615, 0.7200720259053768, 0.8709696524112831, 0.7227649827523976, 0.7969391010987092, 0.7514049240994025, 0.7903304237277295, 0.7903119947410693, 0.6566145378185377, 0.7747980215094084, 0.7436322823688519, 0.5657356615255138, 0.7834573435566974, 0.7932126899355822, 0.6014866480304202, 0.770391416924171, 0.6350465351727854, 0.7763573238567425, 0.7534586601481605, 0.6854645418132155, 0.8917752139251658, 0.7796565342269866, 0.39800453578596184, 0.9472134429176047, 0.7225982876017947, 0.8454464765162488, 0.7569726236088921, 0.6806009819366985, 0.8490503636235431, 0.8476299029823295, 0.8880755132672837, 0.8332830440613892, 0.7643017606841511, 0.5755323372371575, 0.8106441183874475, 0.8760429319154996, 0.9287539506689593, 0.879294443562608, 0.6524762353013671, 0.8183368027080526, 0.49540830292706795, 0.6410591204473797, 0.6476201043576533, 0.748590873870419, 0.6396480580617505, 0.8326769215033576, 0.8851024067772155, 0.8927284326203131, 0.8294976535483187, 0.7456495708434085, 0.5367492297187495, 0.816138666928681, 0.6092271883399942, 0.7985667878835854, 0.3624280610323931, 0.6405605314564717, 0.6057182168451061, 0.8039805578135895, 0.8962426472723293, 0.7753146849809751, 0.5567696243815521, 0.7645772214714557, 0.8024661503475914, 0.8357235704940857, 0.4210272218842468, 0.7950534750781195, 0.6913660556317434, 0.8224411865550831, 0.8309564391862889, 0.8102836386958201, 0.7879316000792136, 0.6253186092484964, 0.5060791553605972, 0.43699599474410733, 0.7414965322287224, 0.56009626180762, 0.8293396694661317, 0.7982085117603017, 0.7559758043728133, 0.7184620306934886, 0.5099880823182608, 0.8520775476372446, 0.7828988244895252, 0.7578655346332053, 0.8760644751579278, 0.6487164094392359, 0.504865379832449, 0.8108770231272537, 0.6023403373191132, 0.7679077273148149, 0.7704707653840022, 0.7393248646872428, 0.7138900254217548, 0.8416753339887386, 0.7831156891942899, 0.582406091686398, 0.7721081884821832, 0.5784959134414651, 0.808082093508695, 0.7094823806153967, 0.8104909307202794, 0.6154632847700328, 0.6854133807505003, 0.7791486368691756, 0.7803752804099606, 0.7820642165877898, 0.7599335963279661, 0.8147092971392678, 0.6492026436057661, 0.9155335701137306, 0.8587517066151993, 0.6716083841603544, 0.8581213155104879, 0.8346429208036421, 0.6477443450707121, 0.7465303501613045, 0.8626163159422922, 0.7575336678302025, 0.7403708452796478, 0.38282222997054327, 0.8316745171091207, 0.8293944250019234, 0.6871444365855484, 0.7936866569042371, 0.7954215750317017, 0.8248195355255066, 0.628854190881514, 0.8084305878672355, 0.786070628874197, 0.5788425093119642, 0.7807600513492352, 0.7927095869710625, 0.8091927371339784, 0.8067038060368736, 0.7284783786146474, 0.7323791460740277, 0.7420449208418944, 0.8326696820163895, 0.7505250579511487, 0.6975293084271394, 0.7471348947744227, 0.7146171096017533, 0.5365148798826376, 0.7632707159332714, 0.7782795484413516, 0.917123270083531, 0.8170489186101693, 0.7552495784182416, 0.766243006857507, 0.7512098745376055, 0.8435014772611862, 0.7987417127004932, 0.7539500080079942, 0.8238871064152093, 0.7418906680394202, 0.7443213614299238, 0.7623447820058884, 0.602760945928716, 0.7894307496736099, 0.7332511035851417, 0.8763327172518232, 0.8154326247341281, 0.8121445364029836, 0.6077718392695124, 0.7660653882595183, 0.7355055196950453, 0.8894930387954878, 0.6889719367323643, 0.4176945480910599, 0.7689458897282464, 0.7776619245948482, 0.4786066109256659, 0.8646808888211563, 0.7316369469344919, 0.8747410951943293, 0.7799296938529674, 0.7586314277885784, 0.8254831073780606, 0.7397429658841947, 0.7098919343066419, 0.7350294686491747, 0.6240582627887072, 0.7609713445085433, 0.7648893477720107, 0.8064525060269843, 0.6488469379993591, 0.7829264192666952, 0.6741047588331448, 0.8953694941524566, 0.7622171638210891, 0.8152127991217377, 0.7535465056622821, 0.7982779408046377, 0.5703021269555084, 0.7164359415172064, 0.20517512000726534, 0.8168519740536058, 0.5035819102147576, 0.7098193502768464, 0.7802884316045218, 0.7133885568880489, 0.4449040574289447, 0.8168297795717303, 0.7918978383391322, 0.7275246146802214, 0.7074979343428851, 0.8582022214027305, 0.7941934997543163, 0.7208510281765641, 0.876493042542067, 0.86815290424065, 0.614525958566807, 0.8263878516466916, 0.7560397200887083, 0.7784556944926557, 0.5968183621600336, 0.6590397605663434, 0.8024595922191706, 0.6788593114830743, 0.3351904024869692, 0.7687456276697555, 0.886107027810761, 0.36665834183779844, 0.7497616906078222, 0.7509920297751143, 0.7734286776684594, 0.7513558710406294, 0.8326839995494562, 0.8187559290346338, 0.7191842462674691, 0.8244024355479749, 0.6477425368480916, 0.6210634195049425, 0.6607636981705716, 0.7661604138925535, 0.5120190634436936, 0.5736103354042525, 0.8029374709059554, 0.22582243164811744, 0.9131890574377242, 0.5320512909266004, 0.6899839877079066, 0.7660710897927185, 0.389552142949537, 0.8171193770383536, 0.744914251307961, 0.774072112778984, 0.7190099479857077, 0.7077433717335551, 0.7716644772038752, 0.7312544627435413, 0.72275101679743, 0.6606344128201143, 0.8853208882874635, 0.8093707139179831, 0.8261622707018843, 0.7385572038843542, 0.7739106453217739, 0.7291730322902705, 0.7445954668361188, 0.675302548753818, 0.7673415490064042, 0.8155178272171535, 0.4573796260155405, 0.6697488407377048, 0.6850416363935994, 0.7839823441743008, 0.7739169753354898, 0.5923191996166752, 0.7295067204683179, 0.8441809208788025, 0.8037223832927751, 0.4735285474437234, 0.7368638317954599, 0.7317041275304013, 0.5832215091962667, 0.8586635154671465, 0.9061287214018556, 0.7401008743040942, 0.8605331288869273, 0.7672569750758387, 0.7950062909534863, 0.8269767839044306, 0.7936303645185137, 0.7079566387639622, 0.7947613262431636, 0.8291805416905096, 0.6926486988501683, 0.5559709727751312, 0.8868717917974822, 0.5429178067366502, 0.8423920847089177, 0.6821292540109127, 0.6924907250830039, 0.6541993324095128, 0.8729160732794805, 0.62745752656471, 0.6491268677866, 0.8172716428295514, 0.709997443381136, 0.6126155346897948, 0.7731815288877544, 0.8113737754809132, 0.8393155924752638, 0.6209640587868377, 0.6487681654245796, 0.7656842287553991, 0.8678725246044261, 0.8065238826590415, 0.7579896983051599, 0.7748333581414137, 0.7832192669654143, 0.8204430189095266, 0.6858698391265616, 0.8583438071975886, 0.7350538437675767, 0.9248875576450095, 0.7340008408054504, 0.7925225755727328, 0.6395558363427754, 0.8052440179580194, 0.834927799385863, 0.7600695922474465, 0.7621478538552788, 0.6680645106867307, 0.8474407393999661, 0.4982055851167708, 0.654010929860003, 0.7880608070469031, 0.5521347474646199, 0.812618320737369, 0.7898622880800394, 0.7377774744743875, 0.7074796967580472, 0.7947472168964451, 0.69911467489764, 0.7890001368884889, 0.7582958433602986, 0.6597580786207466, 0.5369722341358802, 0.7769392771638854, 0.8142566777240161, 0.8152694206892008, 0.7364031153653416, 0.6951723228098141, 0.8460775551298927, 0.5077954281286943, 0.7361801952998646, 0.8481448894224537, 0.8721428538353744, 0.6409985541369363, 0.7388038151976677, 0.7347216207889995, 0.7495076705580692, 0.7706557060816996, 0.6138735455726307, 0.6029511570915249, 0.8726861862216426, 0.6926671367859776, 0.7475007270788583, 0.8313445736363134, 0.7895656574818253, 0.5950899235999876, 0.7473042084989772, 0.7832134531200119, 0.7622598223773738, 0.6253793201620603, 0.6184959040862259, 0.7980331608251083, 0.7487607372219423, 0.8765288449370587, 0.6700093127442204, 0.7824775481449546, 0.8732687343253638, 0.7871558942136041, 0.801548270398776, 0.6307356772444381, 0.7279599227256244, 0.7769289736828748, 0.30605853365479363, 0.8032418257042526, 0.7097673915690701, 0.8197353841626358, 0.807700243820449, 0.763792980427404, 0.6977010275393563, 0.7898575810860076, 0.7535815271919744, 0.859246875162323, 0.7800486151136996, 0.7682656105586789, 0.6932183559173872, 0.8286049103595847, 0.8084463997100768, 0.8322825774278579, 0.6832361402515101, 0.864074073438837, 0.7060776475984032, 0.36322689684555365, 0.7610977199229183, 0.707831401084084, 0.7557712553952138, 0.8058097982089321, 0.6506797990271045, 0.7972071731380084, 0.7645815143180956, 0.8147541990204623, 0.8547553697960055, 0.7294397011142426, 0.8456389184053246, 0.5744632799219513, 0.3912514236342466, 0.7503483785092844, 0.8767390301724085, 0.8353921060744514, 0.6241197571237429, 0.783049508915495, 0.8088730315119277, 0.770976776041689, 0.6230425342873771, 0.509846699469412, 0.6703221839611466, 0.7916886412134982, 0.7758357065837294, 0.8275866068961266, 0.5003238157256578, 0.9058383338077987, 0.8492801456157537, 0.7454410709547494, 0.7770379430084058, 0.7593093024391397, 0.6886624020756724, 0.8201573423355406, 0.783310896433915, 0.8310744211043481, 0.3439783629131201, 0.7860442253586879, 0.7844491584767257, 0.8763373152306475, 0.8056871621073871, 0.30331989380038604, 0.7739180014757692, 0.335906121639548, 0.6967182728261012, 0.5635118568513351, 0.7680835964545267, 0.6801813335980287, 0.12769255187746453, 0.7754614485051736, 0.7745540325392615, 0.7701591688565526, 0.7093638562110691, 0.8668237450921865, 0.7371460163636823, 0.7333885771483335, 0.46851156352081635, 0.7323992692371644, 0.7842159513111417, 0.3442001132830781, 0.7621776058466507, 0.6988469557286658, 0.6572053195038443, 0.7265584249815114, 0.5602503584931011, 0.8017473723799073, 0.5393782855490772, 0.7461450720573064, 0.5364668755417592, 0.790035549939476, 0.8119675012764891, 0.7858141342501235, 0.8518384002586317, 0.8385730515750345, 0.4690724137547122, 0.7904721596373998, 0.8485754733153208, 0.7772960447943371, 0.73638260943791, 0.8265458124362068, 0.8634051071624163, 0.7564893117294968, 0.7894142775372857, 0.7440136493308949]
	with open("appended_s2_10A_test.txt", "r+") as f:
		newlines = ['{} {}\n'.format(old.rstrip('\n'), toadd) for old, toadd in zip(f, s2_list)]
		f.seek(0)
		f.writelines(newlines)

	### Compute RMSE ###
	#print math.sqrt(np.mean((reg.predict(x_test)-y_test)**2))
	### Compute Explained Variance ###
	#print reg.score(x_test, y_test) 
	### Compute Correlation Coefficient ###
	#print (reg.coef_)
	

		
def main():
	#load_set()
	#load_saved_model()
	#append_s2()
	
main()



